<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <div th:replace="~{fragments/header :: head(pageTitle=${producto.nombre})}"></div>
</head>
<body class="d-flex flex-column min-vh-100 bg-primary text-white">
    <div th:replace="~{fragments/header :: header}"></div>
    <div th:replace="~{fragments/cart-offcanvas :: cartOffcanvas}"></div>

    <main class="container my-5 flex-grow-1">
        <div class="row g-5 align-items-center">
            <div class="col-md-5 text-center">
                <img th:if="${#strings.isEmpty(producto.imagenUrl)}" th:src="@{/img/default.webp}" alt="Imagen por defecto" class="img-fluid rounded shadow-lg">
                <img th:unless="${#strings.isEmpty(producto.imagenUrl)}" th:src="${producto.imagenUrl}" th:alt="${producto.nombre}" class="img-fluid rounded shadow-lg">
            </div>
            <div class="col-md-7">
                <h1 class="display-5 fw-bold mb-3" th:text="${producto.nombre}"></h1>
                <h2 class="text-warning mb-4"><strong th:text="${producto.precio} + ' €'"></strong></h2>
                <ul class="list-group list-group-flush bg-transparent mb-4">
                    <li class="list-group-item bg-transparent text-white px-0"><strong>Región:</strong> <span th:text="${producto.region}"></span></li>
                    <li class="list-group-item bg-transparent text-white px-0"><strong>Plataforma:</strong> <span th:text="${producto.plataforma}"></span></li>
                    <li class="list-group-item bg-transparent text-white px-0"><strong>Tipo:</strong> <span th:text="${producto.tipo}"></span></li>
                </ul>
                <div class="d-grid gap-2 d-md-flex align-items-center">
                    <a th:href="@{/login}" sec:authorize="!isAuthenticated()" class="btn btn-success btn-lg me-md-2 flex-grow-1">
                        <i class="bi bi-cart-plus me-2"></i>Añadir al carrito
                    </a>
                    <button sec:authorize="isAuthenticated()"
                            class="btn btn-success btn-lg me-md-2 flex-grow-1 btn-add-to-cart"
                            th:data-product-id="${producto.id}">
                        <i class="bi bi-cart-plus me-2"></i>Añadir al carrito
                    </button>
                    <a th:href="@{/tienda/productosDigitales}" class="btn btn-outline-light btn-lg">
                        <i class="bi bi-arrow-left-circle me-2"></i>Volver
                    </a>
                </div>
            </div>
        </div>
    </main>

    <div th:replace="~{fragments/footer :: footer}"></div>
    <div th:replace="~{fragments/scripts :: scripts}"></div>
</body>
</html>